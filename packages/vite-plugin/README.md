# @praxis/vite-plugin

**Zero-config Vite integration for Praxis universal design system protocol**

## üöÄ **Installation**

```bash
bun add -D @praxis/vite-plugin
# or
npm install -D @praxis/vite-plugin
```

## ‚ö° **Usage**

### **Basic Setup (Zero Config)**

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import { praxis } from '@praxis/vite-plugin'

export default defineConfig({
  plugins: [
    praxis()  // Zero configuration needed!
  ]
})
```

### **Advanced Configuration**

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import { praxis } from '@praxis/vite-plugin'

export default defineConfig({
  plugins: [
    praxis({
      watch: true,                              // Enable file watching (default: true)
      patterns: ['**/*.praxis.yaml'],           // Config file patterns (default)
      outputDir: 'src/types',                   // Where to put generated files (default)
      formats: ['typescript', 'json-schema'],   // What to generate (default)
      verbose: false                            // Enable detailed logging (default: false)
    })
  ]
})
```

## üî• **Features**

### **Zero Configuration**
- ‚úÖ **Works out of the box** - no setup required
- ‚úÖ **Automatic file discovery** - finds all `.praxis.yaml` files
- ‚úÖ **Smart output location** - generates to `src/types/` by default
- ‚úÖ **Sensible defaults** - TypeScript interfaces + JSON schemas

### **Development Experience**
- ‚úÖ **Hot Module Replacement** - instant updates when configs change
- ‚úÖ **Native file watching** - true event-driven (no polling)
- ‚úÖ **Build integration** - runs during Vite build process
- ‚úÖ **Error handling** - clear error messages with file context

### **Platform Native**
- ‚úÖ **Vite-optimized** - leverages Vite's build pipeline
- ‚úÖ **TypeScript first** - generates proper TypeScript interfaces
- ‚úÖ **Bundle efficient** - only processes when files actually change
- ‚úÖ **Performance focused** - cached processing and smart updates

## üìÅ **File Structure**

```
your-project/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.praxis.yaml          # Your component configs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Alert.praxis.yaml
‚îÇ   ‚îî‚îÄ‚îÄ types/                          # Generated automatically
‚îÇ       ‚îú‚îÄ‚îÄ ButtonProps.ts              # TypeScript interfaces
‚îÇ       ‚îú‚îÄ‚îÄ ButtonSchema.json           # JSON schemas  
‚îÇ       ‚îú‚îÄ‚îÄ AlertProps.ts
‚îÇ       ‚îî‚îÄ‚îÄ AlertSchema.json
‚îú‚îÄ‚îÄ vite.config.ts                      # Vite config with Praxis plugin
‚îî‚îÄ‚îÄ package.json
```

## üéØ **Example Component Config**

```yaml
# src/components/Button.praxis.yaml
component:
  name: Button
  description: Primary button component

uses:
  variants: [primary, secondary, danger, warning]
  sizes: [xs, sm, md, lg, xl] 
  states: [isDisabled, isLoading]
  accessibility: [aria-label, aria-describedby]
  interactions: [onClick, onFocus, onBlur]
  styling: [className, style]
```

## üìÑ **Generated Output**

### **TypeScript Interface** (`src/types/ButtonProps.ts`)

```typescript
/**
 * Generated props for Button
 * DO NOT EDIT - Generated by Praxis using Vite plugin
 * @generated 2025-06-06T12:00:00.000Z
 */

export interface ButtonProps {
  /** Component variant */
  variant?: "primary" | "secondary" | "danger" | "warning";
  /** Component size */
  size?: "xs" | "sm" | "md" | "lg" | "xl";
  /** Component state: disabled */
  isDisabled?: boolean;
  /** Component state: loading */
  isLoading?: boolean;
  /** Accessibility: aria-label */
  "aria-label"?: string;
  /** Accessibility: aria-describedby */
  "aria-describedby"?: string;
  /** Event handler: onClick */
  onClick?: (...args: any[]) => any;
  /** Event handler: onFocus */
  onFocus?: (...args: any[]) => any;
  /** Event handler: onBlur */
  onBlur?: (...args: any[]) => any;
  /** Styling: className */
  className?: string;
  /** Styling: style */
  style?: React.CSSProperties;
}

export default ButtonProps;
```

### **JSON Schema** (`src/types/ButtonSchema.json`)

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Button Props",
  "type": "object",
  "properties": {
    "variant": {
      "type": "string",
      "description": "Component variant",
      "enum": ["primary", "secondary", "danger", "warning"]
    },
    "size": {
      "type": "string", 
      "description": "Component size",
      "enum": ["xs", "sm", "md", "lg", "xl"]
    }
  },
  "required": [],
  "additionalProperties": false
}
```

## üîß **Development**

### **File Watching**
The plugin automatically watches for changes to `.praxis.yaml` files during development:

```bash
bun dev
# ‚úÖ Plugin active, watching for changes...
# üëÄ File watching active for .praxis.yaml files
# üîç Found 3 config files
# ‚úÖ Generated interfaces for Button
# ‚úÖ Generated interfaces for Alert
```

### **Hot Module Replacement**
Changes to `.praxis.yaml` files trigger immediate regeneration and HMR updates:

```bash
# Edit Button.praxis.yaml
# ‚úÖ Generated interfaces for Button
# üî• HMR update sent to browser
```

### **Status Endpoint**
Check plugin status during development:

```bash
curl http://localhost:5173/praxis-status
```

```json
{
  "generatedFiles": [
    "src/types/ButtonProps.ts",
    "src/types/ButtonSchema.json"
  ],
  "watchersActive": 1,
  "lastUpdate": 1701234567890
}
```

## üìä **Performance**

- **Bundle size**: ~3KB (minimal overhead)
- **Build time**: <50ms additional per component
- **File watching**: Native FS events (no polling)
- **Memory usage**: Efficient caching and cleanup

## üéØ **Use Cases**

### **Component Libraries**
```typescript
// Use generated types in your components
import type { ButtonProps } from '@/types/ButtonProps'

export const Button: React.FC<ButtonProps> = ({ 
  variant = 'primary',
  size = 'md',
  isDisabled,
  ...props 
}) => {
  return <button className={`btn-${variant} btn-${size}`} {...props} />
}
```

### **API Validation**
```typescript
// Use generated schemas for runtime validation
import buttonSchema from '@/types/ButtonSchema.json'
import Ajv from 'ajv'

const ajv = new Ajv()
const validate = ajv.compile(buttonSchema)

export function validateButtonProps(props: unknown): props is ButtonProps {
  return validate(props)
}
```

### **Storybook Integration**
```typescript
// Auto-generate Storybook args from schemas
import type { Meta, StoryObj } from '@storybook/react'
import { Button } from './Button'
import type { ButtonProps } from '@/types/ButtonProps'

const meta: Meta<ButtonProps> = {
  title: 'Components/Button',
  component: Button,
  argTypes: {
    variant: {
      control: 'select',
      options: ['primary', 'secondary', 'danger', 'warning']
    },
    size: {
      control: 'select', 
      options: ['xs', 'sm', 'md', 'lg', 'xl']
    }
  }
}
```

## üîÑ **Migration**

### **From Manual Interfaces**

**Before:**
```typescript
// Manual interface maintenance
interface ButtonProps {
  variant?: 'primary' | 'secondary'  // Often inconsistent
  size?: 'sm' | 'lg'                 // Missing sizes
  disabled?: boolean                 // Inconsistent naming
  // Missing accessibility props
  // Missing interaction handlers
}
```

**After:**
```yaml
# Single source of truth
component:
  name: Button
uses:
  variants: [primary, secondary, danger, warning]  # Complete and consistent
  sizes: [xs, sm, md, lg, xl]                     # All sizes defined
  states: [isDisabled, isLoading]                 # Consistent naming
  accessibility: [aria-label, aria-describedby]  # Never forgotten
  interactions: [onClick, onFocus, onBlur]       # All handlers included
```

### **Benefits**
- ‚úÖ **95% less manual typing** - generate instead of write
- ‚úÖ **100% consistency** - single source of truth
- ‚úÖ **Zero maintenance overhead** - updates automatically
- ‚úÖ **Never miss props** - comprehensive coverage
- ‚úÖ **Cross-team collaboration** - designers can read YAML

## üìö **API Reference**

### **Plugin Options**

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `watch` | `boolean` | `true` | Enable file watching during development |
| `patterns` | `string[]` | `['**/*.praxis.yaml']` | Glob patterns for config files |
| `outputDir` | `string` | `'src/types'` | Directory for generated files |
| `formats` | `string[]` | `['typescript', 'json-schema']` | Output formats to generate |
| `verbose` | `boolean` | `false` | Enable detailed logging |

### **Generated Files**

| Format | Extension | Description |
|--------|-----------|-------------|
| `typescript` | `.Props.ts` | TypeScript interface definitions |
| `json-schema` | `.Schema.json` | JSON Schema for validation |

## ü§ù **Contributing**

This plugin is part of the Praxis universal design system protocol. See the main repository for contribution guidelines.

## üìÑ **License**

MIT - build amazing things! üöÄ

---

**@praxis/vite-plugin**: *Zero-config Vite integration ‚Ä¢ Platform-native performance ‚Ä¢ Universal design system protocol*